name: GCP Deploy
on:
  push:
    branches: [master]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Cloud Functions Deploy
        uses: google-github-actions/deploy-cloud-functions@v0.1.2
        with:
          credentials: ${{ secrets.GCP_SA_KEY }}
          name: vuanem_FB_Ads_Insights
          env_vars: "ACCESS_TOKEN=${{ secrets.ACCESS_TOKEN }},\
            TELEGRAM_TOKEN=${{ secrets.TELEGRAM_TOKEN }},\
            TELEGRAM_CHAT_ID=${{ secrets.TELEGRAM_CHAT_ID }},\
            API_VER=${{ secrets.API_VER }}"
          entry_point: main
          runtime: python38
          service_account_email: ${{ secrets.GCP_SA }}
          timeout: 60
